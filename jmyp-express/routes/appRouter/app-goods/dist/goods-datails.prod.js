"use strict";var express=require("express"),router=express.Router(),mysql=require("../../../api/mysql/index");router.get("/",function(s,r){var i,c,t,o,p,u,d,n,_;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return r.append("Access-Control-Allow-Origin","*"),i=s.query.id,c={},t=[],o={},p=[],u=[],d=[],n=0,e.next=11,regeneratorRuntime.awrap(mysql("SELECT * FROM product,sku_product,color,size WHERE product.product_id = ".concat(i," AND sku_product.product_id = ").concat(i," AND\n    sku_product.sku_id = color.color_id AND sku_product.sku_id = size.size_id ")));case 11:(_=e.sent).map(function(e){n+=e.stock,console.log(e),p.push({img:e.img,name:e.p_name,title:e.p_title,id:e.sku_id,price:e.vip_price,s1:e.color_id,s2:e.size_id,s3:"0",stock_num:e.stock}),u.push({id:e.color_id,name:e.color,imgUrl:e.img,previewImgUrl:e.img}),d.push({id:e.size_id,name:e.name})}),t={tree:[{k:"颜色",v:u,k_s:"s1"},{k:"尺寸",v:d,k_s:"s2"}],list:p,price:_[0].vip_price,stock_num:n,collection_id:_[0].sku_id,hide_stock:!1},o={title:_[0].p_title,stock:_[0].stock,sales:_[0].sales,describes:_[0].describes,is_put:_[0].is_put,price:_[0].price,vip_price:_[0].vip_price,p_place:_[0].p_place};try{c.code=0,c.msg="请求成功",c.payload={param:o,sku:t}}catch(e){c.code=400,c.param=[],c.msg=e}r.json(c);case 17:case"end":return e.stop()}})}),module.exports=router;