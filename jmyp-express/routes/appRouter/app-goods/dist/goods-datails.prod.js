"use strict";var express=require("express"),router=express.Router(),mysql=require("../../../api/mysql/index");router.get("/",function(s,r){var i,c,t,o,p,u,_,d,n;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return r.append("Access-Control-Allow-Origin","*"),i=s.query.id,c={},t=[],o={},p=[],u=[],_=[],d=0,e.next=11,regeneratorRuntime.awrap(mysql("SELECT * FROM product,sku_product,color,size WHERE product.product_id = ".concat(i," AND sku_product.product_id = ").concat(i," AND\n    sku_product.sku_id = color.color_id AND sku_product.sku_id = size.size_id ")));case 11:(n=e.sent).map(function(e){d+=e.stock,console.log(e),p.push({img:e.img,p_name:e.p_name,p_title:e.p_title,sku_id:e.sku_id,price:e.vip_price,s1:e.color_id,s2:e.size_id,s3:"0",stock_num:e.stock}),u.push({id:e.color_id,name:e.color,imgUrl:e.img,previewImgUrl:e.img}),_.push({id:e.size_id,name:e.name})}),t={tree:[{k:"颜色",v:u,k_s:"s1"},{k:"尺寸",v:_,k_s:"s2"}],list:p,price:n[0].vip_price,stock_num:d,collection_id:n[0].sku_id,hide_stock:!1},o={title:n[0].p_title,stock:n[0].stock,sales:n[0].sales,describes:n[0].describes,is_put:n[0].is_put,price:n[0].price,vip_price:n[0].vip_price,p_place:n[0].p_place};try{c.code=0,c.msg="请求成功",c.payload={param:o,sku:t}}catch(e){c.code=400,c.param=[],c.msg=e}r.json(c);case 17:case"end":return e.stop()}})}),module.exports=router;